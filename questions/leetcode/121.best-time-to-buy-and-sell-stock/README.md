# 121.买卖股票的最佳时机

<https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock/description/>

给定一个数组 `prices` ，它的第 `i` 个元素 `prices[i]` 表示一支给定股票第 `i` 天的价格。

你只能选择 某一天 买入这只股票，并选择在 未来的某一个不同的日子 卖出该股票。设计一个算法来计算你所能获取的最大利润。

返回你可以从这笔交易中获取的最大利润。如果你不能获取任何利润，返回 `0` 。

示例 1：

```txt
输入：[7,1,5,3,6,4]
输出：5
解释：在第 2 天（股票价格 = 1）的时候买入，在第 5 天（股票价格 = 6）的时候卖出，最大利润 = 6-1 = 5 。
     注意利润不能是 7-1 = 6, 因为卖出价格需要大于买入价格；同时，你不能在买入前卖出股票。
```

示例 2：

```txt
输入：prices = [7,6,4,3,1]
输出：0
解释：在这种情况下, 没有交易完成, 所以最大利润为 0。
```

提示：

- `1 <= prices.length <= 10^5`
- `0 <= prices[i] <= 10^4`

## 总结

条件

- 【TODO】

分析

- 【TODO】

### 动态规划+记忆化搜索+记忆简化

分析

- 【TODO】
  - 对于任意交易日来说，当日只有两种情况：
    - 无头寸：无头寸时又有两种情况：
      - 今日卖出：该情况下，利润就是前一交易日的“有头寸”的利润加上今日卖出所得的利润
      - 今日无交易：这意味着前一交易日就没有头寸。该情况下，利润就是前一交易日的“无头寸”的利润
    - 有头寸：有头寸时又有两种情况：
      - 今日买入：该情况下，利润就是当日股票价格的负数，因为买入股票意味着账面暂时损失了买入价格，在卖出之前，利润都是负的
      - 今日无交易：这意味着前一交易日就有头寸。该情况下，利润就是前一交易日的“有头寸”的利润
  - 因此对于任意交易日来说，当日有头寸和无头寸的利润就是：
    - 无头寸利润 = max(今日卖出后无头寸, 今日无交易也无头寸) = max(前一交易日有头寸+今日卖出价格, 前一交易日无头寸利润)
    - 有头寸利润 = max(今日买入后有头寸, 今日无交易但有头寸) = max(-1*今日买入价格, 前一交易日有头寸利润)
  - 令$h(n)$表示第n交易日有头寸利润，$g(n)$表示第n交易日无头寸利润，则n个交易日后的最大利润$f(n)$：

    $
    f(n) = max\left\{\begin{array}{l}
    h(n) = max(-Prices(n), h(n-1)) \\
    g(n) = max(h(n-1)+Prices(n), g(n-1))\\
    \end{array}\right.
    $

    其中，$h(1) = -Prices(1)$，$g(1) = 0$

- 【TODO】
  - 从以上递推式可以看出，任意交易日的结果只取决于前一个交易日，可以简化记忆，每次计算时滚动更新两个变量来记录前一交易日的有头寸和无头寸利润即可

实现

1. TODO

复杂度

- 时间：O(TODO)
- 空间：O(TODO)

### 贪心法

分析

- 【TODO】

实现

1. 设置两个变量，一个记录最低价格，一个记录最高利润
1. 遍历数组的每个元素：
   1. 检查是否低于最低价格：
      - 是：更新最低价格
      - 否：与最低价格相减，检查差值是否高于最高利润：
        - 是：更新最高利润
        - 否：继续
1. 返回最高利润

复杂度

- 时间：O(TODO)
- 空间：O(TODO)
